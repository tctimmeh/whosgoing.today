{% extends "base.html" %}
{% load i18n %}

{% block style %}
{{ block.super }}
<link href="//cdnjs.cloudflare.com/ajax/libs/jquery-timepicker/1.6.0/jquery.timepicker.min.css" rel="stylesheet" />
{% endblock %}

{% block content %}
    <div class="container">
        <h1>{% trans "Who's Going Today?" %}</h1>

        {% if user.is_authenticated %}
            {% if invitations %}
                <h3>Your Pending Invitations</h3>

                <ul>
                    {% for invitation in invitations %}
                        <li><a href="{% url "whosgoing:invitation" inviteId=invitation.inviteId %}">
                            {{ invitation.event.name }}
                        </a></li>
                    {% endfor %}
                </ul>
            {% endif %}

            <h3>Your Events</h3>

            <ul>
                {% for event in events %}
                    <li><a href="{{ event.get_absolute_url }}">{{ event }}</a></li>
                {% empty %}
                    {% trans "You are not a member of any events. Use the button below to create an event and start inviting people!" %}
                {% endfor %}
            </ul>

            <p>
                <button id="create-event-button" class="btn btn-primary">
                    {% trans "Create Event" %}
                </button>
            </p>
        {% endif %}

    </div>
{% endblock %}

{% block script %}
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-timepicker/1.6.0/jquery.timepicker.min.js"></script>
    <script>
        $(document).ready(function() {
            $('#create-event-button').click(function() {
                dcbase.popupAjaxForm({
                    url: "{% url "whosgoing:createEvent" %}",
                    afterLoad: function() {
                        $('#id_time').timepicker({
                            timeFormat: 'g:i a'
                        });
                    }
                });
            });
        });
    </script>
{% endblock %}